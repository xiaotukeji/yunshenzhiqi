(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-member-coupon"],{"179b":function(e,t,o){"use strict";o("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,o("14d9"),o("a434"),o("c975"),o("d3b7"),o("159b"),o("99af"),o("d401"),o("25f0");var n=o("b384"),i={data:function(){return{emptyShow:!1,memberId:0,couponData:[],couponArr:[],repeatFlag:!1}},onLoad:function(e){e.member_id?this.memberId=e.member_id:this.$util.redirectTo("/pages/member/list",{},"redirectTo"),this.$util.checkToken("/pages/member/detail?member_id="+this.memberId)},methods:{isChecked:function(e){e.checked=!e.checked,e.checked?this.couponArr.push(e.coupon_type_id):this.couponArr.splice(this.couponArr.indexOf(e.coupon_type_id),1)},getCouponData:function(e){var t=this,o={page_size:e.size,page:e.num,member_id:this.memberId,status:1};this.mescroll=e,(0,n.getCouponLists)(o).then((function(o){var n=[],i=o.message;0==o.code&&o.data?n=o.data.list:t.$util.showToast({title:i}),e.endSuccess(n.length),1==e.num&&(t.dataList=[]),n.forEach((function(e){t.$set(e,"checked",!1),0==e.validity_type?e.expireTime="有效期："+t.$util.timeStampTurnTime(e.end_time):1==e.validity_type&&(e.expireTime="领取之日起"+e.fixed_term+"天有效")})),t.couponData=t.couponData.concat(n),t.emptyShow=!0,t.$refs.loadingCover&&t.$refs.loadingCover.hide()}))},save:function(){var e=this;if(!this.repeatFlag){this.repeatFlag=!0;var t=this.couponArr.toString();(0,n.sendCoupon)({member_id:this.memberId,parent:t}).then((function(t){e.repeatFlag=!1,0==t.code?(e.$util.showToast({title:"优惠券发放成功"}),setTimeout((function(){e.$util.redirectTo("/pages/member/list")}),1e3)):e.$util.showToast({title:t.message})}))}}}};t.default=i},6428:function(e,t,o){"use strict";o.r(t);var n=o("179b"),i=o.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){o.d(t,e,(function(){return n[e]}))}(a);t["default"]=i.a},"685d":function(e,t,o){"use strict";var n=o("ddfd0"),i=o.n(n);i.a},"8ff6":function(e,t,o){"use strict";o.r(t);var n=o("98dd"),i=o("6428");for(var a in i)["default"].indexOf(a)<0&&function(e){o.d(t,e,(function(){return i[e]}))}(a);o("685d");var c=o("f0c5"),s=Object(c["a"])(i["default"],n["b"],n["c"],!1,null,"7e488d0c",null,!1,n["a"],void 0);t["default"]=s.exports},9439:function(e,t,o){var n=o("24fb");t=n(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n * 建议使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n */.uni-line-hide[data-v-7e488d0c]{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.uni-using-hide[data-v-7e488d0c]{overflow:hidden;width:100%;text-overflow:ellipsis;white-space:nowrap}.prevent-head-roll[data-v-7e488d0c]{position:fixed;left:0;right:0;z-index:998}.coupon[data-v-7e488d0c]{overflow:hidden}.disabled[data-v-7e488d0c]{background-color:#ccc}.coupon-item[data-v-7e488d0c]{display:flex;margin:%?30?% %?30?% 0;height:%?170?%;background-size:contain;background-repeat:no-repeat}.coupon-item .coupon-title[data-v-7e488d0c]{padding-left:%?10?%;display:flex;align-items:center;justify-content:center;flex-direction:column;width:%?198?%;color:#fff;box-sizing:border-box}.coupon-item .coupon-content[data-v-7e488d0c]{display:flex;flex-direction:column;padding:0 %?30?%;width:%?356?%}.coupon-item .coupon-content .coupon-name[data-v-7e488d0c]{margin-top:%?10?%;line-height:1.5;height:%?86?%}.coupon-item .coupon-content .coupon-time[data-v-7e488d0c]{margin-top:%?10?%;border-top:%?2?% dashed #eee;padding-top:%?6?%;font-size:%?24?%}.coupon-item .coupon-money[data-v-7e488d0c]{text-align:center;font-size:%?50?%}.coupon-item .coupon-money uni-text[data-v-7e488d0c]{font-size:%?30?%}.coupon-item .checkbox[data-v-7e488d0c]{color:#909399;margin-right:%?10?%}.footer-wrap[data-v-7e488d0c]{position:fixed;width:100%;bottom:0;padding:%?40?% 0;z-index:10;padding-bottom:calc(constant(safe-area-inset-bottom) + %?100?%);padding-bottom:calc(env(safe-area-inset-bottom) + %?100?%)}',""]),e.exports=t},"98dd":function(e,t,o){"use strict";o.d(t,"b",(function(){return i})),o.d(t,"c",(function(){return a})),o.d(t,"a",(function(){return n}));var n={nsEmpty:o("4172").default,loadingCover:o("200a").default},i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-uni-view",{staticClass:"coupon"},[o("mescroll-uni",{attrs:{refs:"mescroll",size:10},on:{getData:function(t){arguments[0]=t=e.$handleEvent(t),e.getCouponData.apply(void 0,arguments)}}},[o("template",{attrs:{slot:"list"},slot:"list"},[e.couponData.length?e._l(e.couponData,(function(t,n){return o("v-uni-view",{key:n,staticClass:"coupon-item",style:{backgroundImage:"url("+e.$util.img("public/uniapp/shop_uniapp/member/coupon_bg.png")+")"},on:{click:function(o){arguments[0]=o=e.$handleEvent(o),e.isChecked(t)}}},[o("v-uni-view",{staticClass:"coupon-title"},[o("v-uni-text",{staticClass:"coupon-money uni-using-hide"},[o("v-uni-text",[e._v("￥")]),e._v(e._s(parseInt(t.money)))],1),o("v-uni-text",{staticClass:"uni-using-hide"},[e._v("满"+e._s(parseInt(t.at_least))+"可用")])],1),o("v-uni-view",{staticClass:"coupon-content"},[o("v-uni-text",{staticClass:"coupon-name uni-line-hide"},[e._v(e._s(t.coupon_name))]),o("v-uni-text",{staticClass:"coupon-time"},[e._v(e._s(t.expireTime))])],1),o("v-uni-view",{staticClass:"checkbox-wrap"},[o("v-uni-text",{staticClass:"checkbox iconfont",class:t.checked?"iconfuxuankuang1 color-base-text":"iconfuxuankuang2"})],1)],1)})):!e.couponData.length&&e.emptyShow?o("ns-empty"):e._e()],2)],2),e.couponData.length?o("v-uni-view",{staticClass:"footer-wrap"},[o("v-uni-button",{attrs:{type:"primary",disabled:!Boolean(e.couponArr.length)},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.save()}}},[e._v("发放优惠券")])],1):e._e(),o("loading-cover",{ref:"loadingCover"})],1)},a=[]},b384:function(e,t,o){"use strict";o("7a82");var n=o("ee27").default;Object.defineProperty(t,"__esModule",{value:!0}),t.getCouponLists=function(e){return i.default.post("/coupon/shopapi/coupon/lists",{data:e})},t.sendCoupon=function(e){return i.default.post("/coupon/shopapi/coupon/send",{data:e})};var i=n(o("69da"))},ddfd0:function(e,t,o){var n=o("9439");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var i=o("4f06").default;i("3b011edb",n,!0,{sourceMap:!1,shadowMode:!1})}}]);